<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Open Conf 2023 - Web VR Today - WebGL Example</title>
  </head>
  <body onload="start()">
    <canvas id="glcanvas" width="640" height="480"></canvas>
    <script>
      function start() {
        const canvas = document.getElementById('glcanvas');

        const gl = initWebGL(canvas);

        if (gl) {
          gl.clearColor(0.0, 0.0, 0.0, 1.0);
          gl.enable(gl.DEPTH_TEST);
          gl.depthFunc(gl.LEQUAL);
          gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
        }
      }

      function initWebGL(canvas) {
        gl = null;

        try {
          gl =
            canvas.getContext('webgl') ||
            canvas.getContext('experimental-webgl');
        } catch (e) {}

        if (!gl) {
          gl = null;
        }

        return gl;
      }

      function initShaders() {
        const fragmentShader = getShader(gl, 'shader-fs');
        const vertexShader = getShader(gl, 'shader-vs');

        shaderProgram = gl.createProgram();
        gl.attachShader(shaderProgram, vertexShader);
        gl.attachShader(shaderProgram, fragmentShader);
        gl.linkProgram(shaderProgram);

        if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {
          throw new Error('Cannot init shader program...');
        }

        gl.useProgram(shaderProgram);

        vertexPositionAttribute = gl.getAttribLocation(
          shaderProgram,
          'aVertexPosition',
        );
        gl.enableVertexAttribArray(vertexPositionAttribute);
      }
    </script>

    <script id="shader-fs" type="x-shader/x-fragment">
      void main(void) {
        gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);
      }
    </script>

    <script id="shader-vs" type="x-shader/x-vertex">
      attribute vec3 aVertexPosition;

      uniform mat4 uMVMatrix;
      uniform mat4 uPMatrix;

      void main(void) {
        gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);
      }
    </script>
  </body>
</html>
